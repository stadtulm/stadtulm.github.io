





<!DOCTYPE html>
<!--[if lt IE 9]>
<html class="lt-ie9">
<![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]-->
<head>
  <!-- Basic Page Needs
    ================================================== -->
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="robots" content="noindex, nofollow">
  <!-- Mobile Specific Metas
    ================================================== -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Title and meta description
    ================================================== -->
  <title>ulm dev</title>
  <meta property="og:title" content="ulm dev">
  <meta name="description" content="build things, create stuff inside the city of ulm.">
  <meta property="og:description" content="build things, create stuff inside the city of ulm.">

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@ulm_donau" />
  <meta name="twitter:title" content="ulm dev" />
  <meta name="twitter:description" content="build things, create stuff inside the city of ulm." />

  <meta property="og:type" content="article">
  <link rel="canonical" href="/">
  <meta property="og:url" content="/">
  <!-- Favicons
    ================================================== -->
  <!-- 128x128 -->
  <link rel="shortcut icon" type="image/ico" href="/assets/images/favicons/favicon.ico">
  <link rel="icon" type="image/png" href="/assets/images/favicons/favicon.png">
  <!-- 192x192, as recommended for Android
    http://updates.html5rocks.com/2014/11/Support-for-theme-color-in-Chrome-39-for-Android
    -->
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/images/favicons/android-chrome-192x192.png">
  <!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
  <link rel="apple-touch-icon-precomposed" href="/assets/images/favicons/favicon-57.png">
  <!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/images/favicons/favicon-72.png">
  <!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/images/favicons/favicon-114.png">
  <!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/images/favicons/favicon-144.png">
  <!-- CSS
    ================================================== -->
  <!-- env: demo -->
  <link rel="stylesheet" href="/assets/css/styles.css">
</head>
<body class="page-landing-page layout-demo ">
  <a class="usa-skipnav" href="#main-content">Skip to main content</a>
  <div class="usa-overlay"></div>


<header class="usa-header usa-header--basic" role="banner">
  <div class="usa-nav-container">
    <div class="usa-navbar">
      <div class="usa-logo" id="extended-logo">
        <a href="/" title="Home" aria-label="Home">
          <img class="logo-img" src="/assets/images/logo.png" alt="ulm">
          <em class="usa-logo__text">ulm dev</em>
        </a>
      </div>
      <button class="usa-menu-btn">Menu</button>
    </div>
    <nav role="navigation" class="usa-nav">
      <button class="usa-nav__close"><img src="/assets/uswds/img/close.svg" alt="close"></button>
      <ul class="usa-nav__primary usa-accordion">
        
        
        
        
        <li class="usa-nav__primary-item">
          <a class="usa-nav__link" href="/"><span>Home</span></a>
        </li>
        
        
        
        
        <li class="usa-nav__primary-item">
          <button class="usa-accordion__button usa-nav__link" aria-expanded="false" aria-controls="primary-nav-2"><span>Projekte</span></button>
          <ul id="primary-nav-2" class="usa-nav__submenu">
            
            <li class="usa-nav__submenu-item">
              <a href="/projects/openbike/">OpenBike</a>
            </li>
            
            <li class="usa-nav__submenu-item">
              <a href="/projects/digitransit/">digitransit</a>
            </li>
            
          </ul>
        </li>
        
        
        
        
        
        <li class="usa-nav__primary-item">
          <a class="usa-nav__link" href="/blog/"><span>Blog</span></a>
        </li>
        
        
      </ul>
    </nav>
  </div>
</header>

<main class="usa-layout-docs usa-section" id="main-content">
  <div class="grid-container">
    


<div class="grid-row grid-gap">
  <div class="desktop:grid-col-8 usa-prose padding-right-4">
    <h1 class="title">Smarte Schlösser tracken</h1>
    <div class="text-base margin-bottom-2">
        <div class="margin-top-neg-105">
          von <span class="text-bold">Maximilian Richt</span> · 25. Februar 2020
        </div>
    </div>
    <div>
    	<p>Aktuell verbauen wir für den Test an unseren Rädern simple, durchaus schwere, Zahlenschlösser. Jedoch wären Schlösser, die sich von selbst öffnen können, ziemlich praktisch – und so haben wir doch wieder ein Auge auf <a href="https://radforschung.org/log/oh-zwei-schloesser/">die fertigen “smarten” Schlösser, die wir vor einiger Zeit schonmal zerlegt hatten</a> geworfen.</p>

<p>Leider hatten wir bei dem Schloss wieder ein Befestigungsproblem, mit dem auch schon andere Bikesharer zu kämpfen hatten — es passte in unseren Versuchen einfach nicht an den Rahmen am Hinterrad, zudem war bei unseren Fahrradmodellen auch wieder die Hinterradbremse im Weg.</p>

<p><img src="/assets/images/blog/20200225-bikelock.jpg" alt="" /></p>

<p>In Unterstützung durch den ADFC wurde dann ein Stück Gepäckträger gekürzt und das Rücklicht nach unten versetzt, sodass das Schloss jetzt einigermaßen stabil hinten am Fahrrad hängt.</p>

<p>An der Integration in den modularen OpenBike-Software-Stack sind wir gerade dran. So bauen wir gerade einen Adapter für <a href="https://github.com/stadtulm/cykel">cykel</a>, um die Kommunikation mit dem Schloss unabhängig von der eigentlichen Sharingsoftware betreiben zu können. Das Repository und erste Tests für die Protokollimplementation gibt es unter <a href="https://github.com/stadtulm/cykel-lock-bl10">cykel-lock-b10</a>.</p>

<hr />

<p>Wer jedoch nur mit dem Schloss reden möchte, ohne gleich ein ganzes cykel + adaptern aufsetzen zu müssen, oder einfach flott experimentieren möchte, kann auf <a href="https://www.traccar.org">Traccar</a> zurückgreifen. Das ist ein Open Source System zur Kommunikation mit einer ganzen Reihe von unterschiedlichen GPS-Trackern, meist eher mit (Auto)fahrzeug-Fokus.</p>

<p>Traccar hat uns auch geholfen, um das Protokoll des Schlosses grundlegend zu verstehen. In den Logs taucht dort die komplette Kommunikation als Hexdumps auf, was auch super für test-driven Development ist, um herauszufinden, ob unser Parser schritt-für-schritt die Pakete richtig geparst bekommt.</p>

<p>Um selbst mit Traccar und einem Schloss loslegen zu können, reicht die <a href="https://www.traccar.org/quick-start/">Installation von Traccar nach Anleitung</a> auf einer Maschine mit öffentlicher IPv4-Adresse.<br />
Zudem braucht das Schloss eine SIM-Karte, die in den Netzen am Verwendungsort funktioniert und Konfiguration für die Adresse und der Port des eigenen Traccar-Servers. Das wechseln der Simkarte hat <a href="https://drive.google.com/file/d/1lWF9dB44C2lA412ZPyIhHhqCryF2EM_7/view">der Hersteller gut bebildert dokumentiert</a>.</p>

<p>Die Konfiguration erfolgt entweder <a href="https://drive.google.com/file/d/10_dVsOtDC9BFYPz77m9BPHLC086wCIoR/view">per SMS</a> (haben wir bislang nicht getestet) oder mit dem mitgeliefertem USB-Serial-Kabel: dazu den blauen Draht an den schwarzen halten, um das Schloss neuzustarten und die serielle Schnittstelle zu aktivieren. Mit 115200,8N1 verbinden, danach mittels <code class="highlighter-rouge">AT^GT_CM=SERVER,0,&lt;IP&gt;,5023,0</code> (<em>Format: Server, IP(0) oder DNS(1), IP/DNS-Name, Port, TCP(0) oder UDP(1)</em>) den eigenen Traccar-Server hinterlegen. Traccar verwendet für das BL10 den Port 5023 um das <a href="https://www.traccar.org/devices/">kompatible gt06-Protokoll</a> zu sprechen.</p>

<p>Das Schloss kann dann als neues Gerät in Traccar angelegt werden, die Gerätekennung ist die IMEI.</p>

<p><img src="/assets/images/blog/20200225-traccar.jpg" alt="" /></p>

<p>Über die Upload-Symbol-Schaltfläche über der Geräteliste lassen sich Befehle an das Schloss senden. Im auftauchenden Dialog kommt man über <em>Neu &gt; Benutzerdefinierer Befehl</em> dann zum Eingabefeld für das eigentliche Kommando: <code class="highlighter-rouge">UNLOCK#</code></p>

<hr />

<p>Lust darauf, selbst mehr vom Schlossprotokoll zu verstehen? In <a href="https://github.com/stadtulm/cykel-lock-bl10">cykel-lock-b10</a> gibt es den Protokollaufbau und Tests dafür. Mehr Infos zu den Innereien und der verbauten Firmware <a href="https://radforschung.org/log/schloss-am-handgelenk/">haben wir schon mal aufgeschrieben</a>. Wir sind auch weiterhin noch auf der Suche nach möglichst allen AT-Kommandos, die das Schloss versteht - falls ihr noch mehr findet, freuen wir uns gern über eine Nachricht.</p>

    </div>
  </div>
  <aside class="desktop:grid-col-fill margin-top-4 padding-right-4">
      <div class="border-top-1 border-accent-cool-darker padding-top-2 margin-bottom-4 usa-prose">
        <h4 class="">Neuste Beiträge</h4>
        <ul class="usa-list usa-list--unstyled padding-top-2">
          
          <li class="padding-bottom-1"><a class="usa-link" href="/2021/09/03/ixsi-gbfs-converter/">Converter von IXSI nach GBFS für Carsharing</a></li>
          
          <li class="padding-bottom-1"><a class="usa-link" href="/2020/09/25/lora-tracker-konfigurieren/">LoraWAN GPS-Tracker konfigurieren</a></li>
          
          <li class="padding-bottom-1"><a class="usa-link" href="/2020/07/07/openbike_rueckgabe_benachrichtigungen_auth/">Gedanken zur Fahrradrückgabe, Benachrichtigungen und Authentifizierung</a></li>
          
          <li class="padding-bottom-1"><a class="usa-link" href="/2020/06/30/minikonferenz/">Save the date: Eine kleine OpenBike-Konferenz</a></li>
          
          <li class="padding-bottom-1"><a class="usa-link" href="/2020/06/25/openbike-qa-1-kurzbericht/">OpenBike Q&A, ein nachgereichter Blogpost</a></li>
          
        </ul>
      </div>
      <div class="border-top-1 border-accent-cool-darker padding-top-2 margin-bottom-4 usa-prose">
        <h4>Links</h4>
        <ul class="usa-list usa-list--unstyled padding-top-2">
          <li class="padding-bottom-1">
            <svg style="vertical-align: middle;" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 text-primary width-2 margin-right-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
              <path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path>
            </svg>
            <a class="usa-link" href="https://github.com/stadtulm">Github</a>
          </li>
          <li class="padding-bottom-1">
            <svg style="vertical-align: middle;" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" class="svg-inline--fa fa-rss fa-w-14 text-primary width-2 margin-right-2" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
              <path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path>
            </svg>
            <a class="usa-link" href="/feed.xml">RSS Feed</a>
          </li>
        </ul>
      </div>
    </aside>
</div>


  </div>
</main>

<footer class="usa-footer site-footer" role="contentinfo">
  <div class="footer-section-bottom bg-base-lighter">
    <div class="grid-container">
      <div class="grid-row padding-3">
        <div class="tablet:grid-col" >
          <div class="logo-links">
            <a class="footer-logo media_link" href="https://www.ulm.de/leben-in-ulm/digitale-stadt">
              <img src="/assets/images/zda-logo.svg" width="100" alt="Stadt Ulm, Z/DA" />
            </a>
          </div>
        </div>
        <div class="tablet:grid-col"></div>
        <div class="tablet:grid-col">
          <ul class="add-list-reset">
            <li><a href="https://www.ulm.de/leben-in-ulm/digitale-stadt">Digitale Agenda</a></li>
            <li><a href="https://github.com/stadtulm">GitHub</a></li>
          </ul>
        </div>
        <div class="tablet:grid-col">
          <ul class="add-list-reset">
            <li><a href="https://www.ulm.de/sonderseiten/datenschutzerklaerung">Datenschutz</a></li>
            <li><a href="https://www.ulm.de/sonderseiten/impressum">Impressum</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="/assets/uswds/js/uswds.min.js"></script>

</body>
</html>
